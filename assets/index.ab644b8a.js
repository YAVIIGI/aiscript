var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s,o=(e,o)=>{for(var u in o||(o={}))r.call(o,u)&&n(e,u,o[u]);if(t)for(var u of t(o))s.call(o,u)&&n(e,u,o[u]);return e};import{a as u,v as a,s as l,l as i,t as f,b as c,i as h,r as p,w as v,o as d,c as y,d as x,u as m,e as A,F as g,f as b,g as P,h as C,p as w,P as k,j as _}from"./vendor.4481e40c.js";class S extends Error{constructor(e,t){super(e),this.info=t,Error.captureStackTrace&&Error.captureStackTrace(this,S)}}var j=Object.defineProperty,M=Object.getOwnPropertyDescriptor,O=(e,t,r,s)=>{for(var n,o=s>1?void 0:s?M(t,r):t,u=e.length-1;u>=0;u--)(n=e[u])&&(o=(s?n(t,r,o):n(o))||o);return s&&o&&j(t,r,o),o};const $=class{constructor(e=[],t,r){this.opts={},this.layerdStates=e,this.parent=t,this.name=r||(1===e.length?"<root>":"<anonymous>")}log(e,t){this.parent?this.parent.log(e,t):this.opts.log&&this.opts.log(e,t)}onUpdated(e,t){this.parent?this.parent.onUpdated(e,t):this.opts.onUpdated&&this.opts.onUpdated(e,t)}createChildScope(e=new Map,t){const r=[e,...this.layerdStates];return new $(r,this,t)}get(e){for(const t of this.layerdStates)if(t.has(e)){const r=t.get(e);return this.log("read",{var:e,val:r}),r}throw new S(`No such variable '${e}' in scope '${this.name}'`,{scope:this.layerdStates})}getAll(){const e=this.layerdStates.reduce(((e,t)=>[...e,...t]),[]);return new Map(e)}add(e,t){if(this.log("add",{var:e,val:t}),this.layerdStates[0].has(e))throw new S(`Variable '${e}' is alerady exists in scope '${this.name}'`,{scope:this.layerdStates});this.layerdStates[0].set(e,t),null==this.parent&&this.onUpdated(e,t)}assign(e,t){let r=1;for(const s of this.layerdStates){if(s.has(e))return s.set(e,t),this.log("assign",{var:e,val:t}),void(r===this.layerdStates.length&&this.onUpdated(e,t));r++}throw new S(`No such variable '${e}' in scope '${this.name}'`,{scope:this.layerdStates})}};let E=$;O([u],E.prototype,"log",1),O([u],E.prototype,"onUpdated",1),O([u],E.prototype,"createChildScope",1),O([u],E.prototype,"get",1),O([u],E.prototype,"getAll",1),O([u],E.prototype,"add",1),O([u],E.prototype,"assign",1);const N={type:"null"},D={type:"bool",value:!0},H={type:"bool",value:!1},F=e=>({type:"num",value:e}),q=e=>({type:"str",value:e}),I=e=>({type:"bool",value:e}),T=e=>({type:"obj",value:e}),U=e=>({type:"arr",value:e}),z=e=>({type:"fn",native:e});function R(e){if("bool"!==e.type)throw new S(`Expect boolean, but got ${e.type}.`)}function Z(e){if("fn"!==e.type)throw new S(`Expect function, but got ${e.type}.`)}function J(e){if("str"!==e.type)throw new S(`Expect string, but got ${e.type}.`)}function B(e){if("num"!==e.type)throw new S(`Expect number, but got ${e.type}.`)}function V(e){if("obj"!==e.type)throw new S(`Expect object, but got ${e.type}.`)}function L(e){if("arr"!==e.type)throw new S(`Expect array, but got ${e.type}.`)}function Y(e,t){return"fn"!==e.type&&"fn"!==t.type&&("null"===e.type&&"null"===t.type||"null"!==e.type&&"null"!==t.type&&e.value===t.value)}function G(e,t=!1){if(t){if("num"===e.type)return e.value;if("bool"===e.type)return e.value?"true":"false";if("str"===e.type)return`"${e.value}"`;if("arr"===e.type)return`[${e.value.map((e=>G(e,!0))).join(", ")}]`;if("null"===e.type)return"(null)"}const r="num"===e.type||"bool"===e.type?e.value:"str"===e.type?`"${e.value}"`:"fn"===e.type||"obj"===e.type?"...":"null"===e.type?"":null;return`${e.type}<${r}>`}function K(e){switch(e.type){case"arr":return e.value.map((e=>K(e)));case"bool":return e.value;case"null":return null;case"num":return e.value;case"obj":{const t={};for(const[r,s]of e.value.entries())t[r]=K(s);return t}case"str":return e.value;default:return}}function Q(e){if(null===e)return N;if("boolean"==typeof e)return I(e);if("string"==typeof e)return q(e);if("number"==typeof e)return F(e);if(Array.isArray(e))return U(e.map((e=>Q(e))));if("object"==typeof e){const t=new Map;for(const[r,s]of Object.entries(e))t.set(r,Q(s));return T(t)}return N}const W={help:q("SEE: https://github.com/syuilo/aiscript/blob/master/docs/get-started.md"),"Core:v":q("0.11.1"),"Core:ai":q("kawaii"),"Core:not":z((([e])=>(R(e),e.value?H:D))),"Core:eq":z((([e,t])=>Y(e,t)?D:H)),"Core:neq":z((([e,t])=>Y(e,t)?H:D)),"Core:and":z((([e,t])=>(R(e),R(t),e.value&&t.value?D:H))),"Core:or":z((([e,t])=>(R(e),R(t),e.value||t.value?D:H))),"Core:add":z((([e,t])=>(B(e),B(t),F(e.value+t.value)))),"Core:sub":z((([e,t])=>(B(e),B(t),F(e.value-t.value)))),"Core:mul":z((([e,t])=>(B(e),B(t),F(e.value*t.value)))),"Core:div":z((([e,t])=>{B(e),B(t);const r=e.value/t.value;if(isNaN(r))throw new S("Invalid operation.");return F(r)})),"Core:mod":z((([e,t])=>(B(e),B(t),F(e.value%t.value)))),"Core:gt":z((([e,t])=>(B(e),B(t),e.value>t.value?D:H))),"Core:lt":z((([e,t])=>(B(e),B(t),e.value<t.value?D:H))),"Core:gteq":z((([e,t])=>(B(e),B(t),e.value>=t.value?D:H))),"Core:lteq":z((([e,t])=>(B(e),B(t),e.value<=t.value?D:H))),"Core:type":z((([e])=>q(e.type))),"Core:to_str":z((([e])=>"str"===e.type?e:"num"===e.type?q(e.value.toString()):q("?"))),"Core:range":z((([e,t])=>(B(e),B(t),e.value<t.value?U(Array.from({length:t.value-e.value+1},((t,r)=>F(r+e.value)))):e.value>t.value?U(Array.from({length:e.value-t.value+1},((t,r)=>F(e.value-r)))):U([e])))),"Util:uuid":z((()=>q(a()))),"Json:stringify":z((([e])=>q(JSON.stringify(K(e))))),"Json:parse":z((([e])=>(J(e),Q(JSON.parse(e.value))))),"Date:now":z((()=>F(Date.now()))),"Date:year":z((()=>F((new Date).getFullYear()))),"Date:month":z((()=>F((new Date).getMonth()+1))),"Date:day":z((()=>F((new Date).getDate()))),"Date:hour":z((()=>F((new Date).getHours()))),"Date:minute":z((()=>F((new Date).getMinutes()))),"Date:second":z((()=>F((new Date).getSeconds()))),"Date:parse":z((([e])=>(J(e),F(new Date(e.value).getTime())))),"Math:PI":F(Math.PI),"Math:sin":z((([e])=>(B(e),F(Math.sin(e.value))))),"Math:cos":z((([e])=>(B(e),F(Math.cos(e.value))))),"Math:abs":z((([e])=>(B(e),F(Math.abs(e.value))))),"Math:sqrt":z((([e])=>{B(e);const t=Math.sqrt(e.value);if(isNaN(t))throw new S("Invalid operation.");return F(t)})),"Math:round":z((([e])=>(B(e),F(Math.round(e.value))))),"Math:floor":z((([e])=>(B(e),F(Math.floor(e.value))))),"Math:min":z((([e,t])=>(B(e),B(t),F(Math.min(e.value,t.value))))),"Math:max":z((([e,t])=>(B(e),B(t),F(Math.max(e.value,t.value))))),"Math:rnd":z((([e,t])=>e&&"num"===e.type&&t&&"num"===t.type?F(Math.floor(Math.random()*(t.value-e.value+1)+e.value)):F(Math.random()))),"Math:gen_rng":z((([e])=>{if("num"!==e.type&&"str"!==e.type)return N;const t=l(e.value.toString());return z((([e,r])=>e&&"num"===e.type&&r&&"num"===r.type?F(Math.floor(t()*(r.value-e.value+1)+e.value)):F(t())))})),"Num:to_hex":z((([e])=>(B(e),q(e.value.toString(16))))),"Num:from_hex":z((([e])=>(J(e),F(parseInt(e.value,16))))),"Str:lf":q("\n"),"Str:to_num":z((([e])=>{if("num"===e.type)return e;if("str"===e.type){const t=parseInt(e.value,10);return isNaN(t)?N:F(t)}return N})),"Str:len":z((([e])=>"str"!==e.type?F(0):F(i(e.value)))),"Str:pick":z((([e,t])=>{J(e),B(t);const r=f(e.value)[t.value-1];return r?q(r):N})),"Str:incl":z((([e,t])=>(J(e),J(t),e.value.includes(t.value)?D:H))),"Str:slice":z((([e,t,r])=>(J(e),B(t),B(r),q(c(e.value,t.value-1,r.value-1))))),"Str:split":z((([e,t])=>(J(e),t&&J(t),U(t?e.value.split(t?t.value:"").map((e=>q(e))):f(e.value).map((e=>q(e))))))),"Str:replace":z((([e,t,r])=>(J(e),J(t),J(r),q(e.value.split(t.value).join(r.value))))),"Str:index_of":z((([e,t])=>(J(e),J(t),F(h(e.value,t.value)+1)))),"Str:trim":z((([e])=>(J(e),q(e.value.trim())))),"Str:upper":z((([e])=>(J(e),q(e.value.toUpperCase())))),"Str:lower":z((([e])=>(J(e),q(e.value.toLowerCase())))),"Arr:len":z((([e])=>"arr"!==e.type?F(0):F(e.value.length))),"Arr:push":z((([e,t])=>(L(e),e.value.push(t),N))),"Arr:unshift":z((([e,t])=>(L(e),e.value.unshift(t),N))),"Arr:pop":z((([e])=>(L(e),e.value.pop()))),"Arr:shift":z((([e])=>(L(e),e.value.shift()))),"Arr:concat":z((([e,t])=>(L(e),L(t),U(e.value.concat(t.value))))),"Arr:join":z((([e,t])=>(L(e),t&&J(t),q(e.value.map((e=>"str"===e.type?e.value:"")).join(t?t.value:""))))),"Arr:slice":z((([e,t,r])=>(L(e),B(t),B(r),U(e.value.slice(t.value-1,r.value-1))))),"Arr:incl":z((([e,t])=>{if(L(e),"str"!==t.type&&"num"!==t.type&&"bool"!==t.type&&"null"!==t.type)return H;return(r=e,r.value.map((e=>"str"===e.type||"num"===e.type||"bool"===e.type?e.value:"null"===e.type?null:Symbol()))).includes("null"===t.type?null:t.value)?D:H;var r})),"Arr:map":z((async([e,t],r)=>{L(e),Z(t);const s=e.value.map((async(e,s)=>await r.call(t,[e,F(s+1)])));return U(await Promise.all(s))})),"Arr:filter":z((async([e,t],r)=>{L(e),Z(t);const s=[];for(let n=0;n<e.value.length;n++){const o=e.value[n],u=await r.call(t,[o,F(n+1)]);R(u),u.value&&s.push(o)}return U(s)})),"Arr:reduce":z((async([e,t,r],s)=>{L(e),Z(t);const n=null!=r;let o=n?r:e.value[0];for(let u=n?0:1;u<e.value.length;u++){const r=e.value[u];o=await s.call(t,[o,r,F(u+1)])}return o})),"Arr:find":z((async([e,t],r)=>{L(e),Z(t);for(let s=0;s<e.value.length;s++){const n=e.value[s],o=await r.call(t,[n,F(s+1)]);if(R(o),o.value)return n}return N})),"Arr:reverse":z((([e])=>(L(e),e.value.reverse(),N))),"Arr:copy":z((async([e])=>(L(e),U([...e.value])))),"Obj:keys":z((([e])=>(V(e),U(Array.from(e.value.keys()).map((e=>q(e))))))),"Obj:kvs":z((([e])=>(V(e),U(Array.from(e.value.entries()).map((([e,t])=>U([q(e),t]))))))),"Obj:get":z((([e,t])=>(V(e),J(t),e.value.get(t.value)||N))),"Obj:set":z((([e,t,r])=>(V(e),J(t),e.value.set(t.value,r),N))),"Obj:has":z((([e,t])=>(V(e),J(t),I(e.value.has(t.value))))),"Obj:copy":z((([e])=>(V(e),T(new Map(e.value))))),"Async:interval":z((async([e,t,r],s)=>{B(e),Z(t),r&&R(r),r&&s.call(t,[]);const n=setInterval((()=>{s.call(t,[])}),e.value),o=()=>{clearInterval(n)};return s.registerAbortHandler(o),z((([],e)=>{clearInterval(n),e.unregisterAbortHandler(o)}))})),"Async:timeout":z((async([e,t],r)=>{B(e),Z(t);const s=setTimeout((()=>{r.call(t,[])}),e.value),n=()=>{clearTimeout(s)};return r.registerAbortHandler(n),z((([],e)=>{clearTimeout(s),e.unregisterAbortHandler(n)}))}))};function X(e,t,r){return{type:"infixTree",left:e,right:t,info:r}}function ee(e,t,r){if("infixTree"!==e.type)return X(e,t,r);if(r.priority<=e.info.priority)return X(e,t,r);{const{left:s,right:n,info:o}=e;return X(s,ee(n,t,r),o)}}function te(e){return"infixTree"!==e.type?e:{type:"call",name:e.info.func,args:[te(e.left),te(e.right)]}}const re={"*":{func:"Core:mul",priority:7},"/":{func:"Core:div",priority:7},"%":{func:"Core:mod",priority:7},"+":{func:"Core:add",priority:6},"-":{func:"Core:sub",priority:6},"==":{func:"Core:eq",priority:4},"!=":{func:"Core:neq",priority:4},"<":{func:"Core:lt",priority:4},">":{func:"Core:gt",priority:4},"<=":{func:"Core:lteq",priority:4},">=":{func:"Core:gteq",priority:4},"&&":{func:"Core:and",priority:3},"||":{func:"Core:or",priority:2}};function se(e){const t=e.operators.map((e=>{const t=re[e];if(null==t)throw new S(`No such operator: ${e}.`);return t}));let r=X(e.operands[0],e.operands[1],t[0]);for(let s=0;s<t.length-1;s++)r=ee(r,e.operands[2+s],t[1+s]);return te(r)}var ne=Object.defineProperty,oe=Object.getOwnPropertyDescriptor,ue=(e,t,r,s)=>{for(var n,o=s>1?void 0:s?oe(t,r):t,u=e.length-1;u>=0;u--)(n=e[u])&&(o=(s?n(t,r,o):n(o))||o);return s&&o&&ne(t,r,o),o};class ae{constructor(e,t){this.stepCount=0,this.stop=!1,this.abortHandlers=[],this.opts=t||{};const r={print:z((e=>{this.opts.out&&this.opts.out(e[0])})),readline:z((async e=>{const t=e[0];if(J(t),null==this.opts.in)return N;const r=await this.opts.in(t.value);return q(r)}))};this.vars=o(o(o({},e),W),r),this.scope=new E([new Map(Object.entries(this.vars))]),this.scope.opts.log=(e,t)=>{switch(e){case"add":this.log("var:add",t);break;case"read":this.log("var:read",t);break;case"write":this.log("var:write",t)}}}async exec(e){if(null==e||0===e.length)return;await this.collectNs(e);const t=await this._run(e,this.scope);this.log("end",{val:t})}async execFn(e,t){return this._fn(e,t)}static collectMetadata(e){if(null==e||0===e.length)return;function t(e){switch(e.type){case"arr":return e.value.map((e=>t(e)));case"bool":return e.value;case"null":return null;case"num":return e.value;case"obj":{const r={};for(const[s,n]of e.value.entries())r[s]=t(n);return r}case"str":return e.value}}const r=new Map;for(const s of e)switch(s.type){case"meta":r.set(s.name,t(s.value))}return r}log(e,t){this.opts.log&&this.opts.log(e,t)}async collectNs(e){for(const t of e)switch(t.type){case"ns":await this.collectNsMember(t)}}async collectNsMember(e){const t=this.scope.createChildScope();for(const r of e.members)switch(r.type){case"def":{const s=await this._eval(r.expr,t);t.add(r.name,s),this.scope.add(e.name+":"+r.name,s);break}case"ns":break;default:throw new Error("invalid ns member type: "+r.type)}}async _fn(e,t){if(e.native){return await Promise.resolve(e.native(t,{call:this._fn,registerAbortHandler:this.registerAbortHandler,unregisterAbortHandler:this.unregisterAbortHandler}))||N}{const s=new Map;for(let r=0;r<(e.args||[]).length;r++)s.set(e.args[r],t[r]);const n=e.scope.createChildScope(s);return"return"===(r=await this._run(e.statements,n)).type?r.value:r}var r}async _eval(e,t){if(this.stop)return N;if(this.log("node",{node:e}),this.stepCount++,this.opts.maxStep&&this.stepCount>this.opts.maxStep)throw new S("max step exceeded");switch(e.type){case"call":{const r=t.get(e.name);Z(r);const s=await Promise.all(e.args.map((async e=>await this._eval(e,t))));return this._fn(r,s)}case"if":{const r=await this._eval(e.cond,t);if(R(r),r.value)return this._eval(e.then,t);if(e.elseif&&e.elseif.length>0){for(const r of e.elseif){const e=await this._eval(r.cond,t);if(R(e),e.value)return this._eval(r.then,t)}if(e.else)return this._eval(e.else,t)}else if(e.else)return this._eval(e.else,t);return N}case"match":{const r=await this._eval(e.about,t);for(const s of e.qs){if(Y(r,await this._eval(s.q,t)))return await this._eval(s.a,t)}return e.default?await this._eval(e.default,t):N}case"loop":for(;;){const r=await this._run(e.statements,t.createChildScope());if("break"===r.type)break;if("return"===r.type)return r.value}return N;case"for":if(e.times){const r=await this._eval(e.times,t);B(r);for(let s=1;s<r.value+1;s++){const r=await this._eval(e.for,t);if("break"===r.type)break;if("return"===r.type)return r.value}}else{const r=await this._eval(e.from,t),s=await this._eval(e.to,t);B(r),B(s);for(let n=r.value+1;n<s.value+1;n++){const r=await this._eval(e.for,t.createChildScope(new Map([[e.var,F(n)]])));if("break"===r.type)break;if("return"===r.type)return r.value}}return N;case"forOf":{const r=await this._eval(e.items,t);L(r);for(const s of r.value)await this._eval(e.for,t.createChildScope(new Map([[e.var,s]])));return N}case"def":{const r=await this._eval(e.expr,t);if(e.attr.length>0){const s=[];for(const r of e.attr)s.push({name:r.name,value:await this._eval(r.value,t)});r.attr=s}return t.add(e.name,r),N}case"var":return t.get(e.name);case"assign":return t.assign(e.name,await this._eval(e.expr,t)),N;case"propAssign":{let r=t.get(e.obj);const s=e.path[e.path.length-1];for(const t of e.path.slice(0,e.path.length-1)){if(V(r),!r.value.has(t)){r=N;break}r=r.value.get(t)}return V(r),r.value.set(s,await this._eval(e.expr,t)),N}case"indexAssign":{const r=t.get(e.arr);L(r);const s=await this._eval(e.i,t);return B(s),r.value[s.value-1]=await this._eval(e.expr,t),N}case"inc":{const r=t.get(e.name);B(r);const s=await this._eval(e.expr,t);return B(s),r.value+=s.value,N}case"dec":{const r=t.get(e.name);B(r);const s=await this._eval(e.expr,t);return B(s),r.value-=s.value,N}case"null":return N;case"bool":return I(e.value);case"num":return F(e.value);case"str":return q(e.value);case"arr":return U(await Promise.all(e.value.map((async e=>await this._eval(e,t)))));case"obj":{const r=new Map;for(const s of e.value.keys())r.set(s,await this._eval(e.value.get(s),t));return T(r)}case"prop":{let r=t.get(e.obj);for(const t of e.path){if(V(r),!r.value.has(t)){r=N;break}r=r.value.get(t)}return r}case"propCall":{let r=t.get(e.obj);for(const t of e.path){if(V(r),!r.value.has(t)){r=N;break}r=r.value.get(t)}Z(r);const s=await Promise.all(e.args.map((async e=>await this._eval(e,t))));return this._fn(r,s)}case"index":{const r=t.get(e.arr);L(r);const s=await this._eval(e.i,t);return B(s),r.value[s.value-1]}case"fn":return((e,t,r)=>({type:"fn",args:e,statements:t,scope:r}))(e.args.map((e=>e.name)),e.children,t);case"block":return this._run(e.statements,t.createChildScope());case"tmpl":{let r="";for(const s of e.tmpl)if("string"==typeof s)r+=s;else{const e=await this._eval(s,t);let n="";"str"===e.type?n=e.value:"num"===e.type&&(n=e.value.toString()),r+=n}return q(r)}case"infix":return this._eval(se(e),t);case"return":{const r=await this._eval(e.expr,t);return this.log("block:return",{scope:t.name,val:r}),{type:"return",value:r}}case"break":return this.log("block:break",{scope:t.name}),{type:"break",value:null};case"continue":return this.log("block:continue",{scope:t.name}),{type:"continue",value:null};case"ns":case"meta":return N;default:throw new Error("invalid node type")}}async _run(e,t){this.log("block:enter",{scope:t.name});let r=N;for(let s=0;s<e.length;s++){const n=e[s];if(r=await this._eval(n,t),"return"===r.type)return this.log("block:return",{scope:t.name,val:r.value}),r;if("break"===r.type)return this.log("block:break",{scope:t.name}),r;if("continue"===r.type)return this.log("block:continue",{scope:t.name}),r}return this.log("block:leave",{scope:t.name,val:r}),r}registerAbortHandler(e){this.abortHandlers.push(e)}unregisterAbortHandler(e){this.abortHandlers=this.abortHandlers.filter((t=>t!==e))}abort(){this.stop=!0;for(const e of this.abortHandlers)e();this.abortHandlers=[]}}function le(e,t,r,s){var n=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(n,le.prototype),n.expected=t,n.found=r,n.location=s,n.name="SyntaxError",n}function ie(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}function fe(e,t){var r,s,n,o,u={},a=(t=void 0!==t?t:{}).grammarSource,l={Preprocess:Xt,Main:function(){var e,t,r,s,n,o=76*Ut+3,a=Vt[o];if(a)return Ut=a.nextPos,a.result;e=Ut,t=[],r=Er();for(;r!==u;)t.push(r),r=Er();(r=tr())===u&&(r=null);s=[],n=Er();for(;n!==u;)s.push(n),n=Er();return zt=e,e=Pt(r),Vt[o]={nextPos:Ut,result:e},e}},i=Xt,f="//",c="(",h=")",p="{",v="}",d="###",y="let",x=":",m="=",A="<:",g="#[",b="]",P="each",C=",",w="for",k="return",_="loop",S="break",j="continue",M=".",O="[",$="+=",E="-=",N="if",D="elif",H="else",F="match",q="=>",I="eval",T="`",U="\\{",z="\\}",R="\\`",Z='"',J="true",B="false",V="null",L=";",Y="@(",G=/^[A-Z0-9_:]/i,K=/^[\-+*\/%&|=~<>!?]/,Q=/^[+\-]/,W=/^[1-9]/,X=/^[0-9]/,ee=/^[A-Z_]/i,te=/^[A-Z0-9_]/i,re=/^[\r\n]/,se=/^[ \t\r\n]/,ne=/^[ \t]/,oe={type:"any"},ue=Yt("//",!1),ae=Yt("(",!1),ie=Yt(")",!1),fe=Yt("::",!1),ce=Yt("{",!1),he=Yt("}",!1),pe=Yt("###",!1),ve=Yt("let",!1),de=Yt(":",!1),ye=Yt("=",!1),xe=Yt("var",!1),me=Yt("<:",!1),Ae=Yt("#[",!1),ge=Yt("]",!1),be=Yt("each",!1),Pe=Yt(",",!1),Ce=Yt("for",!1),we=Yt("return",!1),ke=Gt([["A","Z"],["0","9"],"_",":"],!1,!0),_e=Yt("loop",!1),Se=Yt("break",!1),je=Yt("continue",!1),Me=Yt(".",!1),Oe=Yt("[",!1),$e=Yt("+=",!1),Ee=Yt("-=",!1),Ne=Yt("\\",!1),De=Yt("||",!1),He=Yt("&&",!1),Fe=Yt("==",!1),qe=Yt("!=",!1),Ie=Yt("<=",!1),Te=Yt(">=",!1),Ue=Yt("<",!1),ze=Yt(">",!1),Re=Yt("+",!1),Ze=Yt("-",!1),Je=Yt("*",!1),Be=Yt("/",!1),Ve=Yt("%",!1),Le=Gt(["-","+","*","/","%","&","|","=","~","<",">","!","?"],!1,!1),Ye=Yt("if",!1),Ge=Yt("elif",!1),Ke=Yt("else",!1),Qe=Yt("match",!1),We=Yt("=>",!1),Xe=Yt("eval",!1),et=Yt("`",!1),tt=Yt("\\{",!1),rt=Yt("\\}",!1),st=Yt("\\`",!1),nt=Yt('"',!1),ot=Yt('\\"',!1),ut=Gt(["+","-"],!1,!1),at=Gt([["1","9"]],!1,!1),lt=Gt([["0","9"]],!1,!1),it=Yt("true",!1),ft=Yt("false",!1),ct=Yt("null",!1),ht=Yt(";",!1),pt=Yt("@",!1),vt=Yt("@(",!1),dt=Gt([["A","Z"],"_"],!1,!0),yt=Gt([["A","Z"],["0","9"],"_"],!1,!0),xt=Yt("\r\n",!1),mt=Gt(["\r","\n"],!1,!1),At=Gt([" ","\t","\r","\n"],!1,!1),gt=Gt([" ","\t"],!1,!1),bt=function(){return Lt()},Pt=function(e){return e||[]},Ct=function(e,t){return t},wt=function(e,t){return[e,...t]},kt=function(e,t,r){return Hr("forOf",{var:e,items:t,for:r})},_t=function(e,t){return t},St=function(e,t,r,s){return Hr("for",{var:e,from:t||Hr("num",{value:0}),to:r,for:s})},jt=function(e,t){return Hr("for",{times:e,for:t})},Mt=function(e,t){return t},Ot=function(e,t,r){return{op:t,term:r}},$t=function(e,t,r){return{q:t,a:r}},Et=function(e,t){return t},Nt=function(){return Lt()[1]},Dt=function(){return Hr("num",{value:parseFloat(Lt())})},Ht=function(){return Hr("num",{value:parseInt(Lt(),10)})},Ft=function(e,t){return{k:e,v:t}},qt=function(e){const t=new Map;for(const r of e)t.set(r.k,r.v);return Hr("obj",{value:t})},It=function(e){return Hr("arr",{value:e})},Tt=function(e,t,r,s,n,o){return(e.length>0||r.length>0)&&function(e,t){throw t=void 0!==t?t:Qt(zt,Ut),function(e,t){return new le(e,null,null,t)}(e,t)}("Cannot use spaces before or after the function name."),Hr("def",{name:t,expr:Hr("fn",{args:s||[],ret:n},o||[]),mut:!1,attr:[]})},Ut=0,zt=0,Rt=[{line:1,column:1}],Zt=0,Jt=[],Bt=0,Vt={};if("startRule"in t){if(!(t.startRule in l))throw new Error("Can't start parsing from rule \""+t.startRule+'".');i=l[t.startRule]}function Lt(){return e.substring(zt,Ut)}function Yt(e,t){return{type:"literal",text:e,ignoreCase:t}}function Gt(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Kt(t){var r,s=Rt[t];if(s)return s;for(r=t-1;!Rt[r];)r--;for(s={line:(s=Rt[r]).line,column:s.column};r<t;)10===e.charCodeAt(r)?(s.line++,s.column=1):s.column++,r++;return Rt[t]=s,s}function Qt(e,t){var r=Kt(e),s=Kt(t);return{source:a,start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:s.line,column:s.column}}}function Wt(e){Ut<Zt||(Ut>Zt&&(Zt=Ut,Jt=[]),Jt.push(e))}function Xt(){var e,t,r,s=76*Ut+0,n=Vt[s];if(n)return Ut=n.nextPos,n.result;for(e=Ut,t=[],r=er();r!==u;)t.push(r),r=er();return zt=e,e=t=t.join(""),Vt[s]={nextPos:Ut,result:e},e}function er(){var t,r,s=76*Ut+1,n=Vt[s];return n?(Ut=n.nextPos,n.result):(t=Ut,(r=dr())!==u&&(zt=t,r=bt()),(t=r)===u&&(t=Ut,(r=xr())!==u&&(zt=t,r=bt()),(t=r)===u&&(t=function(){var t,r,s,n,o,a,l=76*Ut+2,i=Vt[l];if(i)return Ut=i.nextPos,i.result;t=Ut,e.substr(Ut,2)===f?(r=f,Ut+=2):(r=u,0===Bt&&Wt(ue));if(r!==u){for(s=[],n=Ut,o=Ut,Bt++,a=$r(),Bt--,a===u?o=void 0:(Ut=o,o=u),o!==u?(e.length>Ut?(a=e.charAt(Ut),Ut++):(a=u,0===Bt&&Wt(oe)),a!==u?n=o=[o,a]:(Ut=n,n=u)):(Ut=n,n=u);n!==u;)s.push(n),n=Ut,o=Ut,Bt++,a=$r(),Bt--,a===u?o=void 0:(Ut=o,o=u),o!==u?(e.length>Ut?(a=e.charAt(Ut),Ut++):(a=u,0===Bt&&Wt(oe)),a!==u?n=o=[o,a]:(Ut=n,n=u)):(Ut=n,n=u);zt=t,t=""}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(e.length>Ut?(t=e.charAt(Ut),Ut++):(t=u,0===Bt&&Wt(oe)))),Vt[s]={nextPos:Ut,result:t},t)}function tr(){var e,t,r,s,n,o,a,l,i=76*Ut+4,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(e=Ut,(t=sr())!==u){for(r=[],s=Ut,n=[],o=Nr();o!==u;)n.push(o),o=Nr();if((o=Or())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=sr())!==u?(zt=s,s=Ct(0,l)):(Ut=s,s=u)}else Ut=s,s=u;for(;s!==u;){for(r.push(s),s=Ut,n=[],o=Nr();o!==u;)n.push(o),o=Nr();if((o=Or())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=sr())!==u?(zt=s,s=Ct(0,l)):(Ut=s,s=u)}else Ut=s,s=u}zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[i]={nextPos:Ut,result:e},e}function rr(){var e,t,r,s,n,o,a,l,i=76*Ut+6,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(e=Ut,(t=or())!==u){for(r=[],s=Ut,n=[],o=Nr();o!==u;)n.push(o),o=Nr();if((o=Or())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=or())!==u?(zt=s,s=Ct(0,l)):(Ut=s,s=u)}else Ut=s,s=u;for(;s!==u;){for(r.push(s),s=Ut,n=[],o=Nr();o!==u;)n.push(o),o=Nr();if((o=Or())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=or())!==u?(zt=s,s=Ct(0,l)):(Ut=s,s=u)}else Ut=s,s=u}zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[i]={nextPos:Ut,result:e},e}function sr(){var t,r=76*Ut+7,s=Vt[r];return s?(Ut=s.nextPos,s.result):((t=ir())===u&&(t=function(){var t,r,s,n,o,a,l=76*Ut+14,i=Vt[l];if(i)return Ut=i.nextPos,i.result;t=Ut,e.substr(Ut,3)===d?(r=d,Ut+=3):(r=u,0===Bt&&Wt(pe));if(r!==u){for(s=[],n=Nr();n!==u;)s.push(n),n=Nr();if((n=_r())!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();(a=lr())!==u?(zt=t,t=Hr("meta",{name:n,value:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;if(t===u)if(t=Ut,e.substr(Ut,3)===d?(r=d,Ut+=3):(r=u,0===Bt&&Wt(pe)),r!==u){for(s=[],n=Nr();n!==u;)s.push(n),n=Nr();(n=lr())!==u?(zt=t,t=function(e){return Hr("meta",{name:null,value:e})}(n)):(Ut=t,t=u)}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(t=or()),Vt[r]={nextPos:Ut,result:t},t)}function nr(){var e,t=76*Ut+8,r=Vt[t];return r?(Ut=r.nextPos,r.result):((e=fr())===u&&(e=wr())===u&&(e=ir()),Vt[t]={nextPos:Ut,result:e},e)}function or(){var t,r=76*Ut+9,s=Vt[r];return s?(Ut=s.nextPos,s.result):((t=fr())===u&&(t=wr())===u&&(t=function(){var t,r,s,n,o=76*Ut+16,a=Vt[o];if(a)return Ut=a.nextPos,a.result;t=Ut,e.substr(Ut,2)===A?(r=A,Ut+=2):(r=u,0===Bt&&Wt(me));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();(n=ur())!==u?(zt=t,t=Hr("call",{name:"print",args:[n]})):(Ut=t,t=u)}else Ut=t,t=u;return Vt[o]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a=76*Ut+20,l=Vt[a];if(l)return Ut=l.nextPos,l.result;t=Ut,e.substr(Ut,6)===k?(r=k,Ut+=6):(r=u,0===Bt&&Wt(we));if(r!==u)if(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();(o=ur())!==u?(zt=t,t=Hr("return",{expr:o})):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u;return Vt[a]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i=76*Ut+17,f=Vt[i];if(f)return Ut=f.nextPos,f.result;t=Ut,e.substr(Ut,2)===g?(r=g,Ut+=2):(r=u,0===Bt&&Wt(Ae));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if((n=_r())!==u){for(o=Ut,a=[],l=Er();l!==u;)a.push(l),l=Er();for((l=lr())!==u?o=l:(Ut=o,o=u),o===u&&(o=null),a=[],l=Er();l!==u;)a.push(l),l=Er();93===e.charCodeAt(Ut)?(l=b,Ut++):(l=u,0===Bt&&Wt(ge)),l!==u?(zt=t,t=Hr("attr",{name:n,value:o||Hr("bool",{value:!0})})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;return Vt[i]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,p,v,d,x,m,A=76*Ut+18,g=Vt[A];if(g)return Ut=g.nextPos,g.result;t=Ut,e.substr(Ut,4)===P?(r=P,Ut+=4):(r=u,0===Bt&&Wt(be));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(40===e.charCodeAt(Ut)?(n=c,Ut++):(n=u,0===Bt&&Wt(ae)),n!==u)if(e.substr(Ut,3)===y?(o=y,Ut+=3):(o=u,0===Bt&&Wt(ve)),o!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();if((l=_r())!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();for(44===e.charCodeAt(Ut)?(f=C,Ut++):(f=u,0===Bt&&Wt(Pe)),f===u&&(f=null),p=[],v=Er();v!==u;)p.push(v),v=Er();if((v=ur())!==u)if(41===e.charCodeAt(Ut)?(d=h,Ut++):(d=u,0===Bt&&Wt(ie)),d!==u){for(x=[],m=Er();m!==u;)x.push(m),m=Er();(m=Mr())!==u?(zt=t,t=kt(l,v,m)):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;if(t===u)if(t=Ut,e.substr(Ut,4)===P?(r=P,Ut+=4):(r=u,0===Bt&&Wt(be)),r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if(e.substr(Ut,3)===y?(n=y,Ut+=3):(n=u,0===Bt&&Wt(ve)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();if((a=_r())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for(44===e.charCodeAt(Ut)?(i=C,Ut++):(i=u,0===Bt&&Wt(Pe)),i===u&&(i=null),f=[],p=Er();p!==u;)f.push(p),p=Er();if((p=ur())!==u){if(v=[],(d=Er())!==u)for(;d!==u;)v.push(d),d=Er();else v=u;v!==u&&(d=Mr())!==u?(zt=t,t=kt(a,p,d)):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;return Vt[A]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,p,v,d,x,A,g,b=76*Ut+19,P=Vt[b];if(P)return Ut=P.nextPos,P.result;t=Ut,e.substr(Ut,3)===w?(r=w,Ut+=3):(r=u,0===Bt&&Wt(Ce));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(40===e.charCodeAt(Ut)?(n=c,Ut++):(n=u,0===Bt&&Wt(ae)),n!==u)if(e.substr(Ut,3)===y?(o=y,Ut+=3):(o=u,0===Bt&&Wt(ve)),o!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();if((l=_r())!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();if(f=Ut,61===e.charCodeAt(Ut)?(p=m,Ut++):(p=u,0===Bt&&Wt(ye)),p!==u){for(v=[],d=Er();d!==u;)v.push(d),d=Er();(d=ur())!==u?(zt=f,f=_t(0,d)):(Ut=f,f=u)}else Ut=f,f=u;for(f===u&&(f=null),44===e.charCodeAt(Ut)?(p=C,Ut++):(p=u,0===Bt&&Wt(Pe)),p===u&&(p=null),v=[],d=Er();d!==u;)v.push(d),d=Er();if((d=ur())!==u)if(41===e.charCodeAt(Ut)?(x=h,Ut++):(x=u,0===Bt&&Wt(ie)),x!==u){for(A=[],g=Er();g!==u;)A.push(g),g=Er();(g=Mr())!==u?(zt=t,t=St(l,f,d,g)):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;if(t===u){if(t=Ut,e.substr(Ut,3)===w?(r=w,Ut+=3):(r=u,0===Bt&&Wt(Ce)),r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if(e.substr(Ut,3)===y?(n=y,Ut+=3):(n=u,0===Bt&&Wt(ve)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();if((a=_r())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();if(i=Ut,61===e.charCodeAt(Ut)?(f=m,Ut++):(f=u,0===Bt&&Wt(ye)),f!==u){for(p=[],v=Er();v!==u;)p.push(v),v=Er();(v=ur())!==u?(zt=i,i=_t(0,v)):(Ut=i,i=u)}else Ut=i,i=u;for(i===u&&(i=null),44===e.charCodeAt(Ut)?(f=C,Ut++):(f=u,0===Bt&&Wt(Pe)),f===u&&(f=null),p=[],v=Er();v!==u;)p.push(v),v=Er();if((v=ur())!==u){if(d=[],(x=Er())!==u)for(;x!==u;)d.push(x),x=Er();else d=u;d!==u&&(x=Mr())!==u?(zt=t,t=St(a,i,v,x)):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;if(t===u){if(t=Ut,e.substr(Ut,3)===w?(r=w,Ut+=3):(r=u,0===Bt&&Wt(Ce)),r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(40===e.charCodeAt(Ut)?(n=c,Ut++):(n=u,0===Bt&&Wt(ae)),n!==u)if((o=ur())!==u)if(41===e.charCodeAt(Ut)?(a=h,Ut++):(a=u,0===Bt&&Wt(ie)),a!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();(i=Mr())!==u?(zt=t,t=jt(o,i)):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;if(t===u)if(t=Ut,e.substr(Ut,3)===w?(r=w,Ut+=3):(r=u,0===Bt&&Wt(Ce)),r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if((n=ur())!==u){if(o=[],(a=Er())!==u)for(;a!==u;)o.push(a),a=Er();else o=u;o!==u&&(a=Mr())!==u?(zt=t,t=jt(n,a)):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u}}return Vt[b]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f=76*Ut+21,c=Vt[f];if(c)return Ut=c.nextPos,c.result;t=Ut,e.substr(Ut,4)===_?(r=_,Ut+=4):(r=u,0===Bt&&Wt(_e));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(123===e.charCodeAt(Ut)?(n=p,Ut++):(n=u,0===Bt&&Wt(ce)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();if((a=rr())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();125===e.charCodeAt(Ut)?(i=v,Ut++):(i=u,0===Bt&&Wt(he)),i!==u?(zt=t,t=Hr("loop",{statements:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;return Vt[f]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o=76*Ut+22,a=Vt[o];if(a)return Ut=a.nextPos,a.result;t=Ut,e.substr(Ut,5)===S?(r=S,Ut+=5):(r=u,0===Bt&&Wt(Se));r!==u?(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u?(zt=t,t=Hr("break",{})):(Ut=t,t=u)):(Ut=t,t=u);return Vt[o]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o=76*Ut+23,a=Vt[o];if(a)return Ut=a.nextPos,a.result;t=Ut,e.substr(Ut,8)===j?(r=j,Ut+=8):(r=u,0===Bt&&Wt(je));r!==u?(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u?(zt=t,t=Hr("continue",{})):(Ut=t,t=u)):(Ut=t,t=u);return Vt[o]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l=76*Ut+24,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,(r=Sr())!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(61===e.charCodeAt(Ut)?(n=m,Ut++):(n=u,0===Bt&&Wt(ye)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();(a=ur())!==u?(zt=t,t=Hr("assign",{name:r,expr:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i=76*Ut+25,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(t=Ut,(r=Sr())!==u){if(s=[],n=Ut,46===e.charCodeAt(Ut)?(o=M,Ut++):(o=u,0===Bt&&Wt(Me)),o!==u&&(a=_r())!==u?(zt=n,n=Mt(0,a)):(Ut=n,n=u),n!==u)for(;n!==u;)s.push(n),n=Ut,46===e.charCodeAt(Ut)?(o=M,Ut++):(o=u,0===Bt&&Wt(Me)),o!==u&&(a=_r())!==u?(zt=n,n=Mt(0,a)):(Ut=n,n=u);else s=u;if(s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();if(61===e.charCodeAt(Ut)?(o=m,Ut++):(o=u,0===Bt&&Wt(ye)),o!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=ur())!==u?(zt=t,t=Hr("propAssign",{obj:r,path:s,expr:l})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;return Vt[i]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,h,p=76*Ut+26,v=Vt[p];if(v)return Ut=v.nextPos,v.result;if(t=Ut,(r=Sr())!==u)if(91===e.charCodeAt(Ut)?(s=O,Ut++):(s=u,0===Bt&&Wt(Oe)),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();if((o=ur())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();if(93===e.charCodeAt(Ut)?(l=b,Ut++):(l=u,0===Bt&&Wt(ge)),l!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();if(61===e.charCodeAt(Ut)?(f=m,Ut++):(f=u,0===Bt&&Wt(ye)),f!==u){for(c=[],h=Er();h!==u;)c.push(h),h=Er();(h=ur())!==u?(zt=t,t=Hr("indexAssign",{arr:r,i:o,expr:h})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u;return Vt[p]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l=76*Ut+27,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,(r=Sr())!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(e.substr(Ut,2)===$?(n=$,Ut+=2):(n=u,0===Bt&&Wt($e)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();(a=ur())!==u?(zt=t,t=Hr("inc",{name:r,expr:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l=76*Ut+28,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,(r=Sr())!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(e.substr(Ut,2)===E?(n=E,Ut+=2):(n=u,0===Bt&&Wt(Ee)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();(a=ur())!==u?(zt=t,t=Hr("dec",{name:r,expr:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(t=ur()),Vt[r]={nextPos:Ut,result:t},t)}function ur(){var e,t=76*Ut+10,r=Vt[t];return r?(Ut=r.nextPos,r.result):((e=function(){var e,t,r,s,n,o,a,l,i=76*Ut+29,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(e=Ut,(t=ar())!==u){for(r=[],s=Ut,n=[],o=cr();o!==u;)n.push(o),o=cr();if((o=hr())!==u){for(a=[],l=cr();l!==u;)a.push(l),l=cr();(l=ar())!==u?(zt=s,s=Ot(0,o,l)):(Ut=s,s=u)}else Ut=s,s=u;if(s!==u)for(;s!==u;){for(r.push(s),s=Ut,n=[],o=cr();o!==u;)n.push(o),o=cr();if((o=hr())!==u){for(a=[],l=cr();l!==u;)a.push(l),l=cr();(l=ar())!==u?(zt=s,s=Ot(0,o,l)):(Ut=s,s=u)}else Ut=s,s=u}else r=u;r!==u?(zt=e,e=Hr("infix",{operands:[t,...(c=r).map((e=>e.term))],operators:c.map((e=>e.op))})):(Ut=e,e=u)}else Ut=e,e=u;var c;return Vt[i]={nextPos:Ut,result:e},e}())===u&&(e=ar()),Vt[t]={nextPos:Ut,result:e},e)}function ar(){var t,r,s,n,o,a,l=76*Ut+11,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if((t=function(){var t,r,s,n,o,a,l,i,f,c,h=76*Ut+32,p=Vt[h];if(p)return Ut=p.nextPos,p.result;t=Ut,e.substr(Ut,2)===N?(r=N,Ut+=2):(r=u,0===Bt&&Wt(Ye));if(r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if((n=ur())!==u){if(o=[],(a=Er())!==u)for(;a!==u;)o.push(a),a=Er();else o=u;if(o!==u)if((a=Mr())!==u){if(l=Ut,i=[],(f=Er())!==u)for(;f!==u;)i.push(f),f=Er();else i=u;if(i!==u&&(f=function(){var e,t,r,s,n,o,a=76*Ut+33,l=Vt[a];if(l)return Ut=l.nextPos,l.result;if(e=Ut,(t=pr())!==u){for(r=[],s=Ut,n=[],o=Er();o!==u;)n.push(o),o=Er();for((o=pr())!==u?s=o:(Ut=s,s=u);s!==u;){for(r.push(s),s=Ut,n=[],o=Er();o!==u;)n.push(o),o=Er();(o=pr())!==u?s=o:(Ut=s,s=u)}zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[a]={nextPos:Ut,result:e},e}())!==u?l=f:(Ut=l,l=u),l===u&&(l=null),i=Ut,f=[],(c=Er())!==u)for(;c!==u;)f.push(c),c=Er();else f=u;f!==u&&(c=function(){var t,r,s,n,o,a=76*Ut+35,l=Vt[a];if(l)return Ut=l.nextPos,l.result;t=Ut,e.substr(Ut,4)===H?(r=H,Ut+=4):(r=u,0===Bt&&Wt(Ke));if(r!==u)if(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();(o=Mr())!==u?(zt=t,t=o):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u;return Vt[a]={nextPos:Ut,result:t},t}())!==u?i=c:(Ut=i,i=u),i===u&&(i=null),zt=t,t=Hr("if",{cond:n,then:a,elseif:l||[],else:i})}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;return Vt[h]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,d,y,m,A=76*Ut+61,g=Vt[A];if(g)return Ut=g.nextPos,g.result;t=Ut,e.substr(Ut,2)===Y?(r=Y,Ut+=2):(r=u,0===Bt&&Wt(vt));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();for((n=Cr())===u&&(n=null),o=[],a=Er();a!==u;)o.push(a),a=Er();if(41===e.charCodeAt(Ut)?(a=h,Ut++):(a=u,0===Bt&&Wt(ie)),a!==u){for(l=Ut,i=[],f=Er();f!==u;)i.push(f),f=Er();if(58===e.charCodeAt(Ut)?(f=x,Ut++):(f=u,0===Bt&&Wt(de)),f!==u){for(c=[],d=Er();d!==u;)c.push(d),d=Er();(d=kr())!==u?l=d:(Ut=l,l=u)}else Ut=l,l=u;for(l===u&&(l=null),i=[],f=Er();f!==u;)i.push(f),f=Er();if(123===e.charCodeAt(Ut)?(f=p,Ut++):(f=u,0===Bt&&Wt(ce)),f!==u){for(c=[],d=Er();d!==u;)c.push(d),d=Er();for((d=rr())===u&&(d=null),y=[],m=Er();m!==u;)y.push(m),m=Er();125===e.charCodeAt(Ut)?(m=v,Ut++):(m=u,0===Bt&&Wt(he)),m!==u?(zt=t,t=Hr("fn",{args:n||[],ret:l},d||[])):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;return Vt[A]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,h,d,y,x,m,A,g,b=76*Ut+36,P=Vt[b];if(P)return Ut=P.nextPos,P.result;t=Ut,e.substr(Ut,5)===F?(r=F,Ut+=5):(r=u,0===Bt&&Wt(Qe));if(r!==u)if(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();if((o=ur())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();if(123===e.charCodeAt(Ut)?(l=p,Ut++):(l=u,0===Bt&&Wt(ce)),l!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();if(f=[],c=Ut,(h=ur())!==u){for(d=[],y=Er();y!==u;)d.push(y),y=Er();if(e.substr(Ut,2)===q?(y=q,Ut+=2):(y=u,0===Bt&&Wt(We)),y!==u){for(x=[],m=Er();m!==u;)x.push(m),m=Er();if((m=Mr())!==u){for(A=[],g=Er();g!==u;)A.push(g),g=Er();zt=c,c=$t(0,h,m)}else Ut=c,c=u}else Ut=c,c=u}else Ut=c,c=u;if(c!==u)for(;c!==u;)if(f.push(c),c=Ut,(h=ur())!==u){for(d=[],y=Er();y!==u;)d.push(y),y=Er();if(e.substr(Ut,2)===q?(y=q,Ut+=2):(y=u,0===Bt&&Wt(We)),y!==u){for(x=[],m=Er();m!==u;)x.push(m),m=Er();if((m=Mr())!==u){for(A=[],g=Er();g!==u;)A.push(g),g=Er();zt=c,c=$t(0,h,m)}else Ut=c,c=u}else Ut=c,c=u}else Ut=c,c=u;else f=u;if(f!==u){if(c=Ut,42===e.charCodeAt(Ut)?(h="*",Ut++):(h=u,0===Bt&&Wt(Je)),h!==u){for(d=[],y=Er();y!==u;)d.push(y),y=Er();if(e.substr(Ut,2)===q?(y=q,Ut+=2):(y=u,0===Bt&&Wt(We)),y!==u){for(x=[],m=Er();m!==u;)x.push(m),m=Er();if((m=Mr())!==u){for(A=[],g=Er();g!==u;)A.push(g),g=Er();c=m}else Ut=c,c=u}else Ut=c,c=u}else Ut=c,c=u;for(c===u&&(c=null),h=[],d=Er();d!==u;)h.push(d),d=Er();125===e.charCodeAt(Ut)?(d=v,Ut++):(d=u,0===Bt&&Wt(he)),d!==u?(zt=t,t=Hr("match",{about:o,qs:f||[],default:c})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u;return Vt[b]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f=76*Ut+37,c=Vt[f];if(c)return Ut=c.nextPos,c.result;t=Ut,e.substr(Ut,4)===I?(r=I,Ut+=4):(r=u,0===Bt&&Wt(Xe));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(123===e.charCodeAt(Ut)?(n=p,Ut++):(n=u,0===Bt&&Wt(ce)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();if((a=rr())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();125===e.charCodeAt(Ut)?(i=v,Ut++):(i=u,0===Bt&&Wt(he)),i!==u?(zt=t,t=Hr("block",{statements:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;return Vt[f]={nextPos:Ut,result:t},t}())===u&&(t=dr())===u&&(t=xr())===u&&(t=Ar())===u&&(t=gr())===u&&(t=br())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,h,d,y,m,A=76*Ut+56,g=Vt[A];if(g)return Ut=g.nextPos,g.result;t=Ut,123===e.charCodeAt(Ut)?(r=p,Ut++):(r=u,0===Bt&&Wt(ce));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(n=[],o=Ut,(a=_r())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();if(58===e.charCodeAt(Ut)?(i=x,Ut++):(i=u,0===Bt&&Wt(de)),i!==u){if(f=[],(c=Er())!==u)for(;c!==u;)f.push(c),c=Er();else f=u;if(f!==u)if((c=ur())!==u){for(h=[],d=Er();d!==u;)h.push(d),d=Er();for(44===e.charCodeAt(Ut)?(d=C,Ut++):(d=u,0===Bt&&Wt(Pe)),d===u&&(59===e.charCodeAt(Ut)?(d=L,Ut++):(d=u,0===Bt&&Wt(ht))),d===u&&(d=null),y=[],m=Er();m!==u;)y.push(m),m=Er();zt=o,o=Ft(a,c)}else Ut=o,o=u;else Ut=o,o=u}else Ut=o,o=u}else Ut=o,o=u;for(;o!==u;)if(n.push(o),o=Ut,(a=_r())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();if(58===e.charCodeAt(Ut)?(i=x,Ut++):(i=u,0===Bt&&Wt(de)),i!==u){if(f=[],(c=Er())!==u)for(;c!==u;)f.push(c),c=Er();else f=u;if(f!==u)if((c=ur())!==u){for(h=[],d=Er();d!==u;)h.push(d),d=Er();for(44===e.charCodeAt(Ut)?(d=C,Ut++):(d=u,0===Bt&&Wt(Pe)),d===u&&(59===e.charCodeAt(Ut)?(d=L,Ut++):(d=u,0===Bt&&Wt(ht))),d===u&&(d=null),y=[],m=Er();m!==u;)y.push(m),m=Er();zt=o,o=Ft(a,c)}else Ut=o,o=u;else Ut=o,o=u}else Ut=o,o=u}else Ut=o,o=u;125===e.charCodeAt(Ut)?(o=v,Ut++):(o=u,0===Bt&&Wt(he)),o!==u?(zt=t,t=qt(n)):(Ut=t,t=u)}else Ut=t,t=u;return Vt[A]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,h=76*Ut+57,p=Vt[h];if(p)return Ut=p.nextPos,p.result;t=Ut,91===e.charCodeAt(Ut)?(r=O,Ut++):(r=u,0===Bt&&Wt(Oe));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(n=[],o=Ut,(a=ur())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for(44===e.charCodeAt(Ut)?(i=C,Ut++):(i=u,0===Bt&&Wt(Pe)),i===u&&(i=null),f=[],c=Er();c!==u;)f.push(c),c=Er();zt=o,o=a}else Ut=o,o=u;for(;o!==u;)if(n.push(o),o=Ut,(a=ur())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for(44===e.charCodeAt(Ut)?(i=C,Ut++):(i=u,0===Bt&&Wt(Pe)),i===u&&(i=null),f=[],c=Er();c!==u;)f.push(c),c=Er();zt=o,o=a}else Ut=o,o=u;for(o=[],a=Er();a!==u;)o.push(a),a=Er();93===e.charCodeAt(Ut)?(a=b,Ut++):(a=u,0===Bt&&Wt(ge)),a!==u?(zt=t,t=It(n)):(Ut=t,t=u)}else Ut=t,t=u;return Vt[h]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i=76*Ut+38,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(t=Ut,(r=Sr())!==u)if(40===e.charCodeAt(Ut)?(s=c,Ut++):(s=u,0===Bt&&Wt(ae)),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();for((o=vr())===u&&(o=null),a=[],l=Er();l!==u;)a.push(l),l=Er();41===e.charCodeAt(Ut)?(l=h,Ut++):(l=u,0===Bt&&Wt(ie)),l!==u?(zt=t,t=Hr("call",{name:r,args:o||[]})):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u;return Vt[i]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i=76*Ut+40,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(t=Ut,(r=Sr())!==u)if(91===e.charCodeAt(Ut)?(s=O,Ut++):(s=u,0===Bt&&Wt(Oe)),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();if((o=ur())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();93===e.charCodeAt(Ut)?(l=b,Ut++):(l=u,0===Bt&&Wt(ge)),l!==u?(zt=t,t=Hr("index",{arr:r,i:o})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u;return Vt[i]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f=76*Ut+41,p=Vt[f];if(p)return Ut=p.nextPos,p.result;if(t=Ut,(r=Sr())!==u){if(s=[],n=Ut,46===e.charCodeAt(Ut)?(o=M,Ut++):(o=u,0===Bt&&Wt(Me)),o!==u&&(a=_r())!==u?(zt=n,n=Mt(0,a)):(Ut=n,n=u),n!==u)for(;n!==u;)s.push(n),n=Ut,46===e.charCodeAt(Ut)?(o=M,Ut++):(o=u,0===Bt&&Wt(Me)),o!==u&&(a=_r())!==u?(zt=n,n=Mt(0,a)):(Ut=n,n=u);else s=u;if(s!==u)if(40===e.charCodeAt(Ut)?(n=c,Ut++):(n=u,0===Bt&&Wt(ae)),n!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();for((a=vr())===u&&(a=null),l=[],i=Er();i!==u;)l.push(i),i=Er();41===e.charCodeAt(Ut)?(i=h,Ut++):(i=u,0===Bt&&Wt(ie)),i!==u?(zt=t,t=Hr("propCall",{obj:r,path:s,args:a||[]})):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;return Vt[f]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l=76*Ut+42,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,(r=Sr())!==u){if(s=[],n=Ut,46===e.charCodeAt(Ut)?(o=M,Ut++):(o=u,0===Bt&&Wt(Me)),o!==u&&(a=_r())!==u?(zt=n,n=Mt(0,a)):(Ut=n,n=u),n!==u)for(;n!==u;)s.push(n),n=Ut,46===e.charCodeAt(Ut)?(o=M,Ut++):(o=u,0===Bt&&Wt(Me)),o!==u&&(a=_r())!==u?(zt=n,n=Mt(0,a)):(Ut=n,n=u);else s=u;s!==u?(zt=t,t=Hr("prop",{obj:r,path:s})):(Ut=t,t=u)}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(t=function(){var e,t,r=76*Ut+43,s=Vt[r];if(s)return Ut=s.nextPos,s.result;e=Ut,(t=Sr())!==u&&(zt=e,t=Hr("var",{name:t}));return e=t,Vt[r]={nextPos:Ut,result:e},e}())===u)if(t=Ut,40===e.charCodeAt(Ut)?(r=c,Ut++):(r=u,0===Bt&&Wt(ae)),r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if((n=ur())!==u){for(o=[],a=Er();a!==u;)o.push(a),a=Er();41===e.charCodeAt(Ut)?(a=h,Ut++):(a=u,0===Bt&&Wt(ie)),a!==u?(zt=t,t=n):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}function lr(){var t,r=76*Ut+12,s=Vt[r];return s?(Ut=s.nextPos,s.result):((t=Ar())===u&&(t=xr())===u&&(t=gr())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,h=76*Ut+62,p=Vt[h];if(p)return Ut=p.nextPos,p.result;t=Ut,91===e.charCodeAt(Ut)?(r=O,Ut++):(r=u,0===Bt&&Wt(Oe));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(n=[],o=Ut,(a=lr())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for(44===e.charCodeAt(Ut)?(i=C,Ut++):(i=u,0===Bt&&Wt(Pe)),i===u&&(i=null),f=[],c=Er();c!==u;)f.push(c),c=Er();zt=o,o=a}else Ut=o,o=u;for(;o!==u;)if(n.push(o),o=Ut,(a=lr())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for(44===e.charCodeAt(Ut)?(i=C,Ut++):(i=u,0===Bt&&Wt(Pe)),i===u&&(i=null),f=[],c=Er();c!==u;)f.push(c),c=Er();zt=o,o=a}else Ut=o,o=u;for(o=[],a=Er();a!==u;)o.push(a),a=Er();93===e.charCodeAt(Ut)?(a=b,Ut++):(a=u,0===Bt&&Wt(ge)),a!==u?(zt=t,t=It(n)):(Ut=t,t=u)}else Ut=t,t=u;return Vt[h]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f,c,h,d,y,m,A=76*Ut+63,g=Vt[A];if(g)return Ut=g.nextPos,g.result;t=Ut,123===e.charCodeAt(Ut)?(r=p,Ut++):(r=u,0===Bt&&Wt(ce));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();if(n=[],o=Ut,(a=_r())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();if(58===e.charCodeAt(Ut)?(i=x,Ut++):(i=u,0===Bt&&Wt(de)),i!==u){if(f=[],(c=Er())!==u)for(;c!==u;)f.push(c),c=Er();else f=u;if(f!==u)if((c=lr())!==u){for(h=[],d=Er();d!==u;)h.push(d),d=Er();for(44===e.charCodeAt(Ut)?(d=C,Ut++):(d=u,0===Bt&&Wt(Pe)),d===u&&(59===e.charCodeAt(Ut)?(d=L,Ut++):(d=u,0===Bt&&Wt(ht))),d===u&&(d=null),y=[],m=Er();m!==u;)y.push(m),m=Er();zt=o,o=Ft(a,c)}else Ut=o,o=u;else Ut=o,o=u}else Ut=o,o=u}else Ut=o,o=u;for(;o!==u;)if(n.push(o),o=Ut,(a=_r())!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();if(58===e.charCodeAt(Ut)?(i=x,Ut++):(i=u,0===Bt&&Wt(de)),i!==u){if(f=[],(c=Er())!==u)for(;c!==u;)f.push(c),c=Er();else f=u;if(f!==u)if((c=lr())!==u){for(h=[],d=Er();d!==u;)h.push(d),d=Er();for(44===e.charCodeAt(Ut)?(d=C,Ut++):(d=u,0===Bt&&Wt(Pe)),d===u&&(59===e.charCodeAt(Ut)?(d=L,Ut++):(d=u,0===Bt&&Wt(ht))),d===u&&(d=null),y=[],m=Er();m!==u;)y.push(m),m=Er();zt=o,o=Ft(a,c)}else Ut=o,o=u;else Ut=o,o=u}else Ut=o,o=u}else Ut=o,o=u;125===e.charCodeAt(Ut)?(o=v,Ut++):(o=u,0===Bt&&Wt(he)),o!==u?(zt=t,t=qt(n)):(Ut=t,t=u)}else Ut=t,t=u;return Vt[A]={nextPos:Ut,result:t},t}())===u&&(t=br()),Vt[r]={nextPos:Ut,result:t},t)}function ir(){var t,r,s,n,o,a,l,i,f,c,h=76*Ut+13,d=Vt[h];if(d)return Ut=d.nextPos,d.result;if(t=Ut,"::"===e.substr(Ut,2)?(r="::",Ut+=2):(r=u,0===Bt&&Wt(fe)),r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if((n=_r())!==u){if(o=[],(a=Er())!==u)for(;a!==u;)o.push(a),a=Er();else o=u;if(o!==u)if(123===e.charCodeAt(Ut)?(a=p,Ut++):(a=u,0===Bt&&Wt(ce)),a!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for((i=function(){var e,t,r,s,n,o,a,l,i=76*Ut+5,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(e=Ut,(t=nr())!==u){for(r=[],s=Ut,n=[],o=Nr();o!==u;)n.push(o),o=Nr();if((o=Or())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=nr())!==u?(zt=s,s=Ct(0,l)):(Ut=s,s=u)}else Ut=s,s=u;for(;s!==u;){for(r.push(s),s=Ut,n=[],o=Nr();o!==u;)n.push(o),o=Nr();if((o=Or())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=nr())!==u?(zt=s,s=Ct(0,l)):(Ut=s,s=u)}else Ut=s,s=u}zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[i]={nextPos:Ut,result:e},e}())===u&&(i=null),f=[],c=Er();c!==u;)f.push(c),c=Er();125===e.charCodeAt(Ut)?(c=v,Ut++):(c=u,0===Bt&&Wt(he)),c!==u?(zt=t,t=Hr("ns",{name:n,members:i})):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;return Vt[h]={nextPos:Ut,result:t},t}function fr(){var t,r,s,n,o,a,l,i,f,c=76*Ut+15,h=Vt[c];if(h)return Ut=h.nextPos,h.result;if(t=Ut,e.substr(Ut,3)===y?(r=y,Ut+=3):(r=u,0===Bt&&Wt(ve)),r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if((n=_r())!==u){for(o=Ut,a=[],l=Er();l!==u;)a.push(l),l=Er();if(58===e.charCodeAt(Ut)?(l=x,Ut++):(l=u,0===Bt&&Wt(de)),l!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();(f=kr())!==u?o=f:(Ut=o,o=u)}else Ut=o,o=u;for(o===u&&(o=null),a=[],l=Er();l!==u;)a.push(l),l=Er();if(61===e.charCodeAt(Ut)?(l=m,Ut++):(l=u,0===Bt&&Wt(ye)),l!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();(f=ur())!==u?(zt=t,t=Hr("def",{name:n,varType:o,expr:f,mut:!1,attr:[]})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;if(t===u)if(t=Ut,"var"===e.substr(Ut,3)?(r="var",Ut+=3):(r=u,0===Bt&&Wt(xe)),r!==u){if(s=[],(n=Er())!==u)for(;n!==u;)s.push(n),n=Er();else s=u;if(s!==u)if((n=_r())!==u){for(o=Ut,a=[],l=Er();l!==u;)a.push(l),l=Er();if(58===e.charCodeAt(Ut)?(l=x,Ut++):(l=u,0===Bt&&Wt(de)),l!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();(f=kr())!==u?o=f:(Ut=o,o=u)}else Ut=o,o=u;for(o===u&&(o=null),a=[],l=Er();l!==u;)a.push(l),l=Er();if(61===e.charCodeAt(Ut)?(l=m,Ut++):(l=u,0===Bt&&Wt(ye)),l!==u){for(i=[],f=Er();f!==u;)i.push(f),f=Er();(f=ur())!==u?(zt=t,t=function(e,t,r){return Hr("def",{name:e,varType:t,expr:r,mut:!0,attr:[]})}(n,o,f)):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;return Vt[c]={nextPos:Ut,result:t},t}function cr(){var t,r,s,n=76*Ut+30,o=Vt[n];return o?(Ut=o.nextPos,o.result):(t=Ut,92===e.charCodeAt(Ut)?(r="\\",Ut++):(r=u,0===Bt&&Wt(Ne)),r!==u&&(s=Or())!==u?t=r=[r,s]:(Ut=t,t=u),t===u&&(t=Nr()),Vt[n]={nextPos:Ut,result:t},t)}function hr(){var t,r,s,n,o=76*Ut+31,a=Vt[o];return a?(Ut=a.nextPos,a.result):(t=Ut,"||"===e.substr(Ut,2)?(r="||",Ut+=2):(r=u,0===Bt&&Wt(De)),r===u&&("&&"===e.substr(Ut,2)?(r="&&",Ut+=2):(r=u,0===Bt&&Wt(He)),r===u&&("=="===e.substr(Ut,2)?(r="==",Ut+=2):(r=u,0===Bt&&Wt(Fe)),r===u&&("!="===e.substr(Ut,2)?(r="!=",Ut+=2):(r=u,0===Bt&&Wt(qe)),r===u&&("<="===e.substr(Ut,2)?(r="<=",Ut+=2):(r=u,0===Bt&&Wt(Ie)),r===u&&(">="===e.substr(Ut,2)?(r=">=",Ut+=2):(r=u,0===Bt&&Wt(Te)),r===u&&(60===e.charCodeAt(Ut)?(r="<",Ut++):(r=u,0===Bt&&Wt(Ue)),r===u&&(62===e.charCodeAt(Ut)?(r=">",Ut++):(r=u,0===Bt&&Wt(ze)),r===u&&(43===e.charCodeAt(Ut)?(r="+",Ut++):(r=u,0===Bt&&Wt(Re)),r===u&&(45===e.charCodeAt(Ut)?(r="-",Ut++):(r=u,0===Bt&&Wt(Ze)),r===u&&(42===e.charCodeAt(Ut)?(r="*",Ut++):(r=u,0===Bt&&Wt(Je)),r===u&&(47===e.charCodeAt(Ut)?(r="/",Ut++):(r=u,0===Bt&&Wt(Be)),r===u&&(37===e.charCodeAt(Ut)?(r="%",Ut++):(r=u,0===Bt&&Wt(Ve)))))))))))))),r!==u?(s=Ut,Bt++,K.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(Le)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u?(zt=t,t=bt()):(Ut=t,t=u)):(Ut=t,t=u),Vt[o]={nextPos:Ut,result:t},t)}function pr(){var t,r,s,n,o,a,l,i=76*Ut+34,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(t=Ut,e.substr(Ut,4)===D?(r=D,Ut+=4):(r=u,0===Bt&&Wt(Ge)),r!==u)if(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();if((o=ur())!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=Mr())!==u?(zt=t,t={cond:o,then:l}):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;else Ut=t,t=u;return Vt[i]={nextPos:Ut,result:t},t}function vr(){var e,t,r,s,n,o=76*Ut+39,a=Vt[o];if(a)return Ut=a.nextPos,a.result;if(e=Ut,(t=ur())!==u){for(r=[],s=Ut,jr()!==u&&(n=ur())!==u?(zt=s,s=Et(0,n)):(Ut=s,s=u);s!==u;)r.push(s),s=Ut,jr()!==u&&(n=ur())!==u?(zt=s,s=Et(0,n)):(Ut=s,s=u);zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[o]={nextPos:Ut,result:e},e}function dr(){var t,r,s,n,o,a,l=76*Ut+44,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,96===e.charCodeAt(Ut)?(r=T,Ut++):(r=u,0===Bt&&Wt(et)),r!==u){for(s=[],n=Ut,o=Ut,Bt++,96===e.charCodeAt(Ut)?(a=T,Ut++):(a=u,0===Bt&&Wt(et)),Bt--,a===u?o=void 0:(Ut=o,o=u),o!==u&&(a=yr())!==u?(zt=n,n=a):(Ut=n,n=u);n!==u;)s.push(n),n=Ut,o=Ut,Bt++,96===e.charCodeAt(Ut)?(a=T,Ut++):(a=u,0===Bt&&Wt(et)),Bt--,a===u?o=void 0:(Ut=o,o=u),o!==u&&(a=yr())!==u?(zt=n,n=a):(Ut=n,n=u);96===e.charCodeAt(Ut)?(n=T,Ut++):(n=u,0===Bt&&Wt(et)),n!==u?(zt=t,t=Hr("tmpl",{tmpl:Dr(s)})):(Ut=t,t=u)}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}function yr(){var t,r,s,n,o,a,l=76*Ut+45,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if((t=function(){var t,r,s=76*Ut+46,n=Vt[s];if(n)return Ut=n.nextPos,n.result;t=Ut,e.substr(Ut,2)===U?(r=U,Ut+=2):(r=u,0===Bt&&Wt(tt));r!==u&&(zt=t,r=Nt());(t=r)===u&&(t=Ut,e.substr(Ut,2)===z?(r=z,Ut+=2):(r=u,0===Bt&&Wt(rt)),r!==u&&(zt=t,r=Nt()),(t=r)===u&&(t=Ut,e.substr(Ut,2)===R?(r=R,Ut+=2):(r=u,0===Bt&&Wt(st)),r!==u&&(zt=t,r="`"),t=r));return Vt[s]={nextPos:Ut,result:t},t}())===u){if(t=Ut,123===e.charCodeAt(Ut)?(r=p,Ut++):(r=u,0===Bt&&Wt(ce)),r!==u){for(s=[],n=Nr();n!==u;)s.push(n),n=Nr();if((n=ur())!==u){for(o=[],a=Nr();a!==u;)o.push(a),a=Nr();125===e.charCodeAt(Ut)?(a=v,Ut++):(a=u,0===Bt&&Wt(he)),a!==u?(zt=t,t=n):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u;t===u&&(e.length>Ut?(t=e.charAt(Ut),Ut++):(t=u,0===Bt&&Wt(oe)))}return Vt[l]={nextPos:Ut,result:t},t}function xr(){var t,r,s,n,o,a,l=76*Ut+47,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,34===e.charCodeAt(Ut)?(r=Z,Ut++):(r=u,0===Bt&&Wt(nt)),r!==u){for(s=[],n=Ut,o=Ut,Bt++,34===e.charCodeAt(Ut)?(a=Z,Ut++):(a=u,0===Bt&&Wt(nt)),Bt--,a===u?o=void 0:(Ut=o,o=u),o!==u?((a=mr())===u&&(e.length>Ut?(a=e.charAt(Ut),Ut++):(a=u,0===Bt&&Wt(oe))),a!==u?(zt=n,n=a):(Ut=n,n=u)):(Ut=n,n=u);n!==u;)s.push(n),n=Ut,o=Ut,Bt++,34===e.charCodeAt(Ut)?(a=Z,Ut++):(a=u,0===Bt&&Wt(nt)),Bt--,a===u?o=void 0:(Ut=o,o=u),o!==u?((a=mr())===u&&(e.length>Ut?(a=e.charAt(Ut),Ut++):(a=u,0===Bt&&Wt(oe))),a!==u?(zt=n,n=a):(Ut=n,n=u)):(Ut=n,n=u);34===e.charCodeAt(Ut)?(n=Z,Ut++):(n=u,0===Bt&&Wt(nt)),n!==u?(zt=t,t=Hr("str",{value:s.join("")})):(Ut=t,t=u)}else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}function mr(){var t,r,s=76*Ut+48,n=Vt[s];return n?(Ut=n.nextPos,n.result):(t=Ut,'\\"'===e.substr(Ut,2)?(r='\\"',Ut+=2):(r=u,0===Bt&&Wt(ot)),r!==u&&(zt=t,r='"'),t=r,Vt[s]={nextPos:Ut,result:t},t)}function Ar(){var t,r=76*Ut+49,s=Vt[r];return s?(Ut=s.nextPos,s.result):((t=function(){var t,r,s,n,o,a,l=76*Ut+50,i=Vt[l];if(i)return Ut=i.nextPos,i.result;t=Ut,Q.test(e.charAt(Ut))?(e.charAt(Ut),Ut++):0===Bt&&Wt(ut);r=[],W.test(e.charAt(Ut))?(s=e.charAt(Ut),Ut++):(s=u,0===Bt&&Wt(at));if(s!==u)for(;s!==u;)r.push(s),W.test(e.charAt(Ut))?(s=e.charAt(Ut),Ut++):(s=u,0===Bt&&Wt(at));else r=u;if(r!==u){if(s=[],X.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(lt)),n!==u)for(;n!==u;)s.push(n),X.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(lt));else s=u;if(s!==u)if(46===e.charCodeAt(Ut)?(n=M,Ut++):(n=u,0===Bt&&Wt(Me)),n!==u){if(o=[],X.test(e.charAt(Ut))?(a=e.charAt(Ut),Ut++):(a=u,0===Bt&&Wt(lt)),a!==u)for(;a!==u;)o.push(a),X.test(e.charAt(Ut))?(a=e.charAt(Ut),Ut++):(a=u,0===Bt&&Wt(lt));else o=u;o!==u?(zt=t,t=Dt()):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u}else Ut=t,t=u;if(t===u)if(t=Ut,Q.test(e.charAt(Ut))?(e.charAt(Ut),Ut++):0===Bt&&Wt(ut),X.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=u,0===Bt&&Wt(lt)),r!==u)if(46===e.charCodeAt(Ut)?(s=M,Ut++):(s=u,0===Bt&&Wt(Me)),s!==u){if(n=[],X.test(e.charAt(Ut))?(o=e.charAt(Ut),Ut++):(o=u,0===Bt&&Wt(lt)),o!==u)for(;o!==u;)n.push(o),X.test(e.charAt(Ut))?(o=e.charAt(Ut),Ut++):(o=u,0===Bt&&Wt(lt));else n=u;n!==u?(zt=t,t=Dt()):(Ut=t,t=u)}else Ut=t,t=u;else Ut=t,t=u;return Vt[l]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o=76*Ut+51,a=Vt[o];if(a)return Ut=a.nextPos,a.result;t=Ut,Q.test(e.charAt(Ut))?(e.charAt(Ut),Ut++):0===Bt&&Wt(ut);W.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=u,0===Bt&&Wt(at));if(r!==u){if(s=[],X.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(lt)),n!==u)for(;n!==u;)s.push(n),X.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(lt));else s=u;s!==u?(zt=t,t=Ht()):(Ut=t,t=u)}else Ut=t,t=u;t===u&&(t=Ut,Q.test(e.charAt(Ut))?(e.charAt(Ut),Ut++):0===Bt&&Wt(ut),X.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=u,0===Bt&&Wt(lt)),r!==u?(zt=t,t=Ht()):(Ut=t,t=u));return Vt[o]={nextPos:Ut,result:t},t}()),Vt[r]={nextPos:Ut,result:t},t)}function gr(){var t,r=76*Ut+52,s=Vt[r];return s?(Ut=s.nextPos,s.result):((t=function(){var t,r,s,n,o=76*Ut+53,a=Vt[o];if(a)return Ut=a.nextPos,a.result;t=Ut,e.substr(Ut,4)===J?(r=J,Ut+=4):(r=u,0===Bt&&Wt(it));r!==u?(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u?(zt=t,t=Hr("bool",{value:!0})):(Ut=t,t=u)):(Ut=t,t=u);return Vt[o]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o=76*Ut+54,a=Vt[o];if(a)return Ut=a.nextPos,a.result;t=Ut,e.substr(Ut,5)===B?(r=B,Ut+=5):(r=u,0===Bt&&Wt(ft));r!==u?(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u?(zt=t,t=Hr("bool",{value:!1})):(Ut=t,t=u)):(Ut=t,t=u);return Vt[o]={nextPos:Ut,result:t},t}()),Vt[r]={nextPos:Ut,result:t},t)}function br(){var t,r,s,n,o=76*Ut+55,a=Vt[o];return a?(Ut=a.nextPos,a.result):(t=Ut,e.substr(Ut,4)===V?(r=V,Ut+=4):(r=u,0===Bt&&Wt(ct)),r!==u?(s=Ut,Bt++,G.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(ke)),Bt--,n===u?s=void 0:(Ut=s,s=u),s!==u?(zt=t,t=Hr("null",{})):(Ut=t,t=u)):(Ut=t,t=u),Vt[o]={nextPos:Ut,result:t},t)}function Pr(){var t,r,s,n,o,a,l,i=76*Ut+58,f=Vt[i];if(f)return Ut=f.nextPos,f.result;if(t=Ut,(r=_r())!==u){for(s=Ut,n=[],o=Er();o!==u;)n.push(o),o=Er();if(58===e.charCodeAt(Ut)?(o=x,Ut++):(o=u,0===Bt&&Wt(de)),o!==u){for(a=[],l=Er();l!==u;)a.push(l),l=Er();(l=kr())!==u?s=l:(Ut=s,s=u)}else Ut=s,s=u;s===u&&(s=null),zt=t,t={name:r,type:s}}else Ut=t,t=u;return Vt[i]={nextPos:Ut,result:t},t}function Cr(){var e,t,r,s,n,o=76*Ut+59,a=Vt[o];if(a)return Ut=a.nextPos,a.result;if(e=Ut,(t=Pr())!==u){for(r=[],s=Ut,jr()!==u&&(n=Pr())!==u?s=n:(Ut=s,s=u);s!==u;)r.push(s),s=Ut,jr()!==u&&(n=Pr())!==u?s=n:(Ut=s,s=u);zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[o]={nextPos:Ut,result:e},e}function wr(){var t,r,s,n,o,a,l,i,f,d,y,m,A,g,b,P,C,w=76*Ut+60,k=Vt[w];if(k)return Ut=k.nextPos,k.result;if(t=Ut,64===e.charCodeAt(Ut)?(r="@",Ut++):(r=u,0===Bt&&Wt(pt)),r!==u){for(s=[],n=Nr();n!==u;)s.push(n),n=Nr();if((n=_r())!==u){for(o=[],a=Nr();a!==u;)o.push(a),a=Nr();if(40===e.charCodeAt(Ut)?(a=c,Ut++):(a=u,0===Bt&&Wt(ae)),a!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();for((i=Cr())===u&&(i=null),f=[],d=Er();d!==u;)f.push(d),d=Er();if(41===e.charCodeAt(Ut)?(d=h,Ut++):(d=u,0===Bt&&Wt(ie)),d!==u){for(y=Ut,m=[],A=Er();A!==u;)m.push(A),A=Er();if(58===e.charCodeAt(Ut)?(A=x,Ut++):(A=u,0===Bt&&Wt(de)),A!==u){for(g=[],b=Er();b!==u;)g.push(b),b=Er();(b=kr())!==u?y=b:(Ut=y,y=u)}else Ut=y,y=u;for(y===u&&(y=null),m=[],A=Er();A!==u;)m.push(A),A=Er();if(123===e.charCodeAt(Ut)?(A=p,Ut++):(A=u,0===Bt&&Wt(ce)),A!==u){for(g=[],b=Er();b!==u;)g.push(b),b=Er();for((b=rr())===u&&(b=null),P=[],C=Er();C!==u;)P.push(C),C=Er();125===e.charCodeAt(Ut)?(C=v,Ut++):(C=u,0===Bt&&Wt(he)),C!==u?(zt=t,t=Tt(s,n,o,i,y,b)):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;return Vt[w]={nextPos:Ut,result:t},t}function kr(){var t,r=76*Ut+64,s=Vt[r];return s?(Ut=s.nextPos,s.result):((t=function(){var t,r,s,n,o,a,l,i,f,c,p=76*Ut+65,v=Vt[p];if(v)return Ut=v.nextPos,v.result;t=Ut,e.substr(Ut,2)===Y?(r=Y,Ut+=2):(r=u,0===Bt&&Wt(vt));if(r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();for((n=function(){var e,t,r,s,n,o=76*Ut+66,a=Vt[o];if(a)return Ut=a.nextPos,a.result;if(e=Ut,(t=kr())!==u){for(r=[],s=Ut,jr()!==u&&(n=kr())!==u?s=n:(Ut=s,s=u);s!==u;)r.push(s),s=Ut,jr()!==u&&(n=kr())!==u?s=n:(Ut=s,s=u);zt=e,e=wt(t,r)}else Ut=e,e=u;return Vt[o]={nextPos:Ut,result:e},e}())===u&&(n=null),o=[],a=Er();a!==u;)o.push(a),a=Er();if(41===e.charCodeAt(Ut)?(a=h,Ut++):(a=u,0===Bt&&Wt(ie)),a!==u){for(l=[],i=Er();i!==u;)l.push(i),i=Er();if(e.substr(Ut,2)===q?(i=q,Ut+=2):(i=u,0===Bt&&Wt(We)),i!==u){for(f=[],c=Er();c!==u;)f.push(c),c=Er();(c=kr())!==u?(zt=t,t=Hr("fn",{args:n||[],result:c})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;return Vt[p]={nextPos:Ut,result:t},t}())===u&&(t=function(){var t,r,s,n,o,a,l,i,f=76*Ut+67,c=Vt[f];if(c)return Ut=c.nextPos,c.result;if(t=Ut,(r=_r())!==u){for(s=[],n=Nr();n!==u;)s.push(n),n=Nr();if(60===e.charCodeAt(Ut)?(n="<",Ut++):(n=u,0===Bt&&Wt(Ue)),n!==u){for(o=[],a=Nr();a!==u;)o.push(a),a=Nr();if((a=kr())!==u){for(l=[],i=Nr();i!==u;)l.push(i),i=Nr();62===e.charCodeAt(Ut)?(i=">",Ut++):(i=u,0===Bt&&Wt(ze)),i!==u?(zt=t,t=Hr("named",{name:r,inner:a})):(Ut=t,t=u)}else Ut=t,t=u}else Ut=t,t=u}else Ut=t,t=u;t===u&&(t=Ut,(r=_r())!==u&&(zt=t,r=function(e){return Hr("named",{name:e,inner:null})}(r)),t=r);return Vt[f]={nextPos:Ut,result:t},t}()),Vt[r]={nextPos:Ut,result:t},t)}function _r(){var t,r,s,n,o=76*Ut+68,a=Vt[o];if(a)return Ut=a.nextPos,a.result;if(t=Ut,ee.test(e.charAt(Ut))?(r=e.charAt(Ut),Ut++):(r=u,0===Bt&&Wt(dt)),r!==u){for(s=[],te.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(yt));n!==u;)s.push(n),te.test(e.charAt(Ut))?(n=e.charAt(Ut),Ut++):(n=u,0===Bt&&Wt(yt));zt=t,t=bt()}else Ut=t,t=u;return Vt[o]={nextPos:Ut,result:t},t}function Sr(){var t,r,s,n,o,a=76*Ut+69,l=Vt[a];if(l)return Ut=l.nextPos,l.result;if(t=Ut,_r()!==u){for(r=[],s=Ut,58===e.charCodeAt(Ut)?(n=x,Ut++):(n=u,0===Bt&&Wt(de)),n!==u&&(o=_r())!==u?s=n=[n,o]:(Ut=s,s=u);s!==u;)r.push(s),s=Ut,58===e.charCodeAt(Ut)?(n=x,Ut++):(n=u,0===Bt&&Wt(de)),n!==u&&(o=_r())!==u?s=n=[n,o]:(Ut=s,s=u);zt=t,t=bt()}else Ut=t,t=u;return Vt[a]={nextPos:Ut,result:t},t}function jr(){var t,r,s,n,o,a=76*Ut+70,l=Vt[a];if(l)return Ut=l.nextPos,l.result;for(t=Ut,r=[],s=Er();s!==u;)r.push(s),s=Er();if(44===e.charCodeAt(Ut)?(s=C,Ut++):(s=u,0===Bt&&Wt(Pe)),s!==u){for(n=[],o=Er();o!==u;)n.push(o),o=Er();t=r=[r,s,n]}else Ut=t,t=u;if(t===u)if(t=[],(r=Er())!==u)for(;r!==u;)t.push(r),r=Er();else t=u;return Vt[a]={nextPos:Ut,result:t},t}function Mr(){var t,r,s,n,o,a,l=76*Ut+71,i=Vt[l];if(i)return Ut=i.nextPos,i.result;if(t=Ut,123===e.charCodeAt(Ut)?(r=p,Ut++):(r=u,0===Bt&&Wt(ce)),r!==u){for(s=[],n=Er();n!==u;)s.push(n),n=Er();for((n=rr())===u&&(n=null),o=[],a=Er();a!==u;)o.push(a),a=Er();125===e.charCodeAt(Ut)?(a=v,Ut++):(a=u,0===Bt&&Wt(he)),a!==u?(zt=t,t=Hr("block",{statements:n||[]})):(Ut=t,t=u)}else Ut=t,t=u;return t===u&&(t=or()),Vt[l]={nextPos:Ut,result:t},t}function Or(){var t,r=76*Ut+72,s=Vt[r];return s?(Ut=s.nextPos,s.result):("\r\n"===e.substr(Ut,2)?(t="\r\n",Ut+=2):(t=u,0===Bt&&Wt(xt)),t===u&&(re.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=u,0===Bt&&Wt(mt))),Vt[r]={nextPos:Ut,result:t},t)}function $r(){var t,r,s=76*Ut+73,n=Vt[s];return n?(Ut=n.nextPos,n.result):(t=Ut,Bt++,e.length>Ut?(r=e.charAt(Ut),Ut++):(r=u,0===Bt&&Wt(oe)),Bt--,r===u?t=void 0:(Ut=t,t=u),t===u&&(t=Or()),Vt[s]={nextPos:Ut,result:t},t)}function Er(){var t,r=76*Ut+74,s=Vt[r];return s?(Ut=s.nextPos,s.result):(se.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=u,0===Bt&&Wt(At)),Vt[r]={nextPos:Ut,result:t},t)}function Nr(){var t,r=76*Ut+75,s=Vt[r];return s?(Ut=s.nextPos,s.result):(ne.test(e.charAt(Ut))?(t=e.charAt(Ut),Ut++):(t=u,0===Bt&&Wt(gt)),Vt[r]={nextPos:Ut,result:t},t)}function Dr(e){let t=function(e,t){const r=[];for(let s=0;s<e.length;s++)0!=s&&t(e[s-1],e[s])?r[r.length-1].push(e[s]):r.push([e[s]]);return r}(e,((e,t)=>typeof t==typeof e));return t=t.map((e=>"string"==typeof e[0]?[e.join("")]:e)),function(e){return e.reduce(((e,t)=>e.concat(t)),[])}(t)}function Hr(e,t,r){const s={type:e};t.children=r;for(const o of Object.keys(t))void 0!==t[o]&&(s[o]=t[o]);const n=Qt(zt,Ut);return s.loc={start:n.start.offset,end:n.end.offset-1},s}if((r=i())!==u&&Ut===e.length)return r;throw r!==u&&Ut<e.length&&Wt({type:"end"}),s=Jt,n=Zt<e.length?e.charAt(Zt):null,o=Zt<e.length?Qt(Zt,Zt+1):Qt(Zt,Zt),new le(le.buildMessage(s,n),s,n,o)}ue([u],ae.prototype,"exec",1),ue([u],ae.prototype,"execFn",1),ue([u],ae.prototype,"log",1),ue([u],ae.prototype,"collectNs",1),ue([u],ae.prototype,"collectNsMember",1),ue([u],ae.prototype,"_fn",1),ue([u],ae.prototype,"_eval",1),ue([u],ae.prototype,"_run",1),ue([u],ae.prototype,"registerAbortHandler",1),ue([u],ae.prototype,"unregisterAbortHandler",1),ue([u],ae.prototype,"abort",1),ue([u],ae,"collectMetadata",1),function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(le,Error),le.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,s=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){s=e[r].text.split(/\r\n|\n|\r/g);break}var n=this.location.start,o=this.location.source+":"+n.line+":"+n.column;if(s){var u=this.location.end,a=ie("",n.line.toString().length),l=s[n.line-1],i=n.line===u.line?u.column:l.length+1;t+="\n --\x3e "+o+"\n"+a+" |\n"+n.line+" | "+l+"\n"+a+" | "+ie("",n.column-1)+ie("",i-n.column,"^")}else t+="\n at "+o}return t},le.buildMessage=function(e,t){var r,s={literal:function(e){return'"'+o(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?u(e[0])+"-"+u(e[1]):u(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function o(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function u(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function a(e){return s[e.type](e)}return"Expected "+function(e){var t,r,s=e.map(a);if(s.sort(),s.length>0){for(t=1,r=1;t<s.length;t++)s[t-1]!==s[t]&&(s[r]=s[t],r++);s.length=r}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+(((r=t)?'"'+o(r)+'"':"end of input")+" found.")};const ce=["null","true","false","each","for","loop","break","continue","match","if","elif","else","return","eval","var","let","fn","namespace","meta","attr","attribute","static","class","struct","module","while","import","export"];function he(e){var t;for(const r of e)switch(r.type){case"def":case"assign":case"ns":if(ce.includes(r.name))throw new ve(`Reserved word "${r.name}" cannot be used as variable name.`);break;case"fn":he(r.children);break;case"block":he(r.statements);break;case"if":"block"===r.then.type&&he(r.then.statements);for(const e of r.elseif)"block"===e.then.type&&he(e.then.statements);"block"===(null==(t=r.else)?void 0:t.type)&&he(r.else.statements)}return e}class pe extends Error{constructor(e){let t="Syntax error.";e&&(t+=` ${e}`),super(t)}}class ve extends Error{constructor(e){let t="Semantic error.";e&&(t+=` ${e}`),super(t)}}function de(e){return{type:"simple",name:e}}function ye(e){switch(e.type){case"named":if(e.inner){const t=ye(e.inner);return`${e.name}<${t}>`}return e.name;case"fn":return`@(${e.args.map((e=>ye(e))).join(", ")}) => ${ye(e.result)}`}}function xe(e){if("named"===e.type){switch(e.name){case"null":case"bool":case"num":case"str":case"any":case"void":if(null==e.inner)return de(e.name);break;case"arr":case"obj":{let t;return t=null!=e.inner?xe(e.inner):de("any"),{type:"generic",name:e.name,inners:[t]}}}throw new ve(`Unknown type: '${ye(e)}'`)}{const s=e.args.map((e=>xe(e)));return t=s,r=xe(e.result),{type:"fn",args:t,result:r}}var t,r}function me(e){switch(e.type){case"def":null!=e.varType&&xe(e.varType),me(e.expr);break;case"fn":for(const t of e.args)null!=t.type&&xe(t.type);null!=e.ret&&xe(e.ret);for(const t of e.children)me(t)}}function Ae(e){for(const t of e)me(t);return e}function ge(e){const t=[],r=[];for(const s of e)if("attr"===s.type)r.push(s);else if("def"===s.type)s.attr.push(...r),r.splice(0,r.length),"fn"===s.expr.type&&(s.expr.children=ge(s.expr.children)),t.push(s);else{if(r.length>0)throw new ve("invalid attribute.");switch(s.type){case"fn":s.children=ge(s.children);break;case"block":s.statements=ge(s.statements)}t.push(s)}if(r.length>0)throw new ve("invalid attribute.");return t}class be{constructor(){this.plugins=[he,Ae,ge]}static parse(e){return null==be.instance&&(be.instance=new be),be.instance.parse(e)}addPlugin(e){this.plugins.push(e)}parse(e){let t;try{const r=fe(e,{startRule:"Preprocess"});t=fe(r,{startRule:"Main"})}catch(r){if(r.location)throw r.expected?new pe(`Line ${r.location.start.line}:${r.location.start.column}`):new pe(`${r.message} Line ${r.location.start.line}:${r.location.start.column}`);throw r}for(const s of this.plugins)t=s(t);return t}}const Pe={id:"root"},Ce=x("h1",null,"AiScript (v0.11.1) Playground",-1),we={id:"grid1"},ke={id:"editor",class:"container"},_e=C("Input"),Se={key:0,class:"syntaxError"},je={id:"logs",class:"container"},Me=x("header",null,"Output",-1),Oe={class:"type"},$e={id:"grid2"},Ee={id:"ast",class:"container"},Ne=x("header",null,"AST",-1),De=x("div",{id:"bin",class:"container"},[x("header",null,"Bytecode"),x("div")],-1),He=x("div",{id:"debugger",class:"container"},[x("header",null,"Debugger"),x("div")],-1);_({setup(e){const t=p(window.localStorage.getItem("script")||'<: "Hello, AiScript!"'),r=p(null),s=p([]),n=p(!1);v(t,(()=>{window.localStorage.setItem("script",t.value);try{r.value=be.parse(t.value),n.value=!1}catch(e){return n.value=!0,void console.error(e)}}),{immediate:!0});const o=()=>{t.value='for (#i, 100) {\n  <: if (i % 15 == 0) "FizzBuzz"\n    elif (i % 3 == 0) "Fizz"\n    elif (i % 5 == 0) "Buzz"\n    else i\n}'},u=async()=>{s.value=[];const e=new ae({},{in:e=>new Promise((t=>{t(window.prompt(e))})),out:e=>{s.value.push({id:Math.random(),type:e.type,text:"str"===e.type||"num"===e.type?e.value:G(e),print:!0})},log:(e,t)=>{switch(e){case"end":s.value.push({id:Math.random(),text:G(t.val,!0),print:!1})}}});try{await e.exec(r.value)}catch(t){console.error(t),window.alert("Error: "+t)}},a=e=>w.exports.highlight(e,w.exports.languages.js,"javascript");return(e,l)=>(d(),y("div",Pe,[Ce,x("div",we,[x("div",ke,[x("header",null,[_e,x("div",{class:"actions"},[x("button",{onClick:o},"FizzBuzz")])]),x("div",null,[x(m(k),{class:"code",modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=e=>t.value=e),highlight:a,"line-numbers":!1},null,8,["modelValue"])]),x("footer",null,[n.value?(d(),y("span",Se,"Syntax Error!")):A("",!0),x("div",{class:"actions"},[x("button",{onClick:u},"RUN")])])]),x("div",je,[Me,x("div",null,[(d(!0),y(g,null,b(s.value,(e=>(d(),y("div",{class:["log",[{print:e.print},e.type]],key:e.id},[x("span",Oe,P(e.type),1),C(" "+P(e.text),1)],2)))),128))])])]),x("div",$e,[x("div",Ee,[Ne,x("div",null,[x("pre",null,P(JSON.stringify(r.value,null,"\t")),1)])]),De,He])]))}}).mount("#app");
